allinone
========

> All-in-on model based custom predictions

Install

``` r
remotes::install_github("ABbiodiversity/allinone")
```

Load the package, then download and load the coefs, etc.

``` r
library(allinone)

#ai_dowload_coefs()

ai_load_coefs()
## [INFO] Loading coefs

tab <- ai_species()
str(tab)
## 'data.frame':    2594 obs. of  21 variables:
##  $ SpeciesID     : chr  "Bryoria.fuscescens.glabra.lanestris.vrangiana" ...
##  $ ScientificName: chr  "Bryoria fuscescens/glabra/lanestris/vrangiana" ...
##  $ TSNID         : chr  "99002220" "99002875" "98283083" "99002154" ...
##  $ CommonName    : chr  NA NA NA NA ...
##  $ ModelNorth    : logi  TRUE FALSE FALSE FALSE FALSE TRUE ...
##  $ ModelSouth    : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...
##  $ UseavailNorth : logi  FALSE TRUE TRUE FALSE TRUE FALSE ...
##  $ UseavailSouth : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ Occurrences   : int  2719 213 151 58 75 1921 1968 2231 2055 402 ...
##  $ nSites        : int  1028 148 73 28 58 846 1006 1008 887 197 ...
##  $ SizeNorth     : logi  NA NA NA NA NA NA ...
##  $ SizeSouth     : logi  NA NA NA NA NA NA ...
##  $ Nonnative     : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ LinkHabitat   : chr  "logit" "logit" "logit" "logit" ...
##  $ LinkSpclim    : chr  "logit" "logit" "logit" "logit" ...
##  $ AUCNorth      : num  0.926 0.808 NA NA 0.785 0.864 0.797 0.844 0.869 NA ...
##  $ AUCSouth      : num  0.912 0.881 0.911 0.936 0.879 0.918 0.834 0.926 0.888 0.871 ...
##  $ R2North       : num  0.494 0.15 NA NA 0.09 0.336 0.214 0.3 0.352 NA ...
##  $ R2South       : num  0.356 0.236 0.327 0.359 0.188 0.306 0.213 0.4 0.221 0.297 ...
##  $ Comments      : chr  NA NA NA NA ...
##  $ Group         : chr  "lichens" "lichens" "lichens" "lichens" ...

## example data to see what is needed and how it is formatted
load(system.file("extdata/example.RData", package="allinone"))

## define species and bootstrap id
spp <- "AlderFlycatcher"
i <- 1

## use composition
z1 <- ai_predict(spp, 
  spclim=spclim, 
  veghf=p_veghf, 
  soilhf=p_soilhf,
  i=i)
## [INFO] Making predictions for species AlderFlycatcher (birds)
str(z1)
## List of 2
##  $ north: num [1:2880, 1:231] NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:2880] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:231] "0" "0.000182796893495837" "0.000240745654448181" "0.00031033593035311" ...
##  $ south: num [1:30, 1:19] 0.00 0.00 6.64e-07 0.00 1.41e-05 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:30] "1167_502" "964_613" "1194_487" "973_442" ...
##   .. ..$ : chr [1:19] "RapidDrain" "Crop" "RoughP" "TameP" ...

## averaging predictions
Combo <- spclim$wN * rowSums(z1$north) + (1-spclim$wN) * rowSums(z1$south)
str(Combo)
##  Named num [1:2880] NA NA NA NA NA NA NA NA NA NA ...
##  - attr(*, "names")= chr [1:2880] "1" "2" "3" "4" ...

## use land cover classes
z2 <- ai_predict(spp, 
  spclim=spclim, 
  veghf=spclim$veghf, 
  soilhf=spclim$soilhf,
  i=i)
## [INFO] Making predictions for species AlderFlycatcher (birds)
str(z2)
## List of 2
##  $ north: num [1:30, 1:15] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:30] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:15] "CCDeciduous2" "CCDeciduousR" "Crop" "GrassHerb" ...
##  $ south: num [1:30, 1:7] 0 0 0 0 0 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:30] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:7] "Blowout" "Crop" "RapidDrain" "RoughP" ...
```
